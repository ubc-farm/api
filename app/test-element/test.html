<!doctype html>
<html>
	<head>
		<title>React Testing</title>
		<script>window.STORE = {}</script>
		<script src='tape.js'></script>
		<script src="https://fb.me/react-15.2.1.js"></script>
		<script src="https://fb.me/react-dom-15.2.1.js"></script>
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
		<link href='../core-styles/core.min.css' rel='stylesheet'>
		<link href='../../lib/table-interactive/table.css' rel='stylesheet'>
		<script async src='../../lib/table-interactive/bundle.js'></script>
		<script src='../../lib/money/bundle.js'></script>
		<script>
			function render(element, props) {
				ReactDOM.render(
					React.createElement(element, props), 
					document.getElementById('app-mount')
				)
			}

			const schema = {
				name: 'string',
				icon: 'object',
				role: 'string',
				hourlyPay: 'number'
			}

			const tooltips = new Map([
				['icon', {title: ' '}]
			])

			function icon(name) {
				return React.createElement('i', {className: 'material-icons'}, name)
			}

			function yey() {
				fetch('http://localhost:3000/api/directory').then(response => response.json())
				.then(json => Object.keys(json).map(k => {
					const obj = json[k];
					switch (obj.role) {
						case 'Restaurant': obj.icon = icon('restaurant'); break;
						case 'Employee': obj.icon = icon('business'); break;
					}
					return obj;
				}))
				.then(data => render(T.default, {
					data, selection: true, sorting: true,
					tooltips, schema
				}))
			}
		</script>
	</head>
	<body onload="yey()">
		<div id='app-mount'/>
	</body>
</html>