<!doctype html>
<html>
	<head>
		<title>React Testing</title>
		<script>window.STORE = {}</script>
		<script src='tape.js'></script>
		<script src="https://fb.me/react-15.2.1.js"></script>
		<script src="https://fb.me/react-dom-15.2.1.js"></script>
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
		<link href='../core-styles/core.min.css' rel='stylesheet'>
		<link href='../../lib/table-controls/table.css' rel='stylesheet'>
		<script src='../../lib/table-controls/bundle.js'></script>
		<script src='../../lib/money/bundle.js'></script>
		<script>
			function render(element, props) {
				ReactDOM.render(
					React.createElement(element, props), 
					document.getElementById('app-mount')
				)
			}

			const Input = ({children, type='text'}) => 
				React.createElement('input', {type, value: children});

			const {Column, Table, Cell} = T;

			const columns = [
				new Column({
					columnKey: 'item',
					compareFunc: true
				}),
				new Column({
					columnKey: 'description',
					compareFunc: true,
					toElement(text, props) {
						return React.createElement(Cell, props, 
							React.createElement(Input, {}, text)
						)
					}
				}),
				new Column({
					columnKey: 'unitCost',
					title: 'Unit Cost ($)',
					description: 'Cost per unit of this item',
					getValue(rowData, columnKey) {
						const cents = rowData[columnKey];
						if (cents !== undefined) return new Money(cents);
					},
					toElement(money, props) {
						const moneyString = 
							money !== undefined ? money.toString() : undefined; 
						return React.createElement(Cell, props, moneyString);
					},
					compareFunc(a = 0, b = 0) {
						return b - a;
					},
					align: 'right'
				}),
				new Column({
					columnKey: 'quantity',
					compareFunc: true,
					align: 'right'
				}),
				new Column({
					columnKey: 'price',
					title: 'Price ($)',
					description: 'Total price of all the items',
					compareFunc: true,
					getValue(rowData) {
						const total = rowData.unitCost * rowData.quantity;
						if (!Number.isNaN(total)) return new Money(total);
					},
					toElement(money, props) {
						const moneyString = money !== undefined ? 
							money.toString() : undefined; 
						return React.createElement(Cell, props, moneyString);
					},
					compareFunc(a = 0, b = 0) {
						return b - a;
					},
					align: 'right'
				}),
			];

			const testData = {
				'example': {
					item: 'Beets, lb',
					description: '4540 Beets, lb',
					unitCost: 200,
					quantity: 25
				},'example2': {
					item: 'Squash, kg',
					description: 'Squash Variety 1, kg',
					unitCost: 400,
					quantity: 10
				}
			}

			const data = new Map(
				Object.keys(testData).map(key => {
					let value = testData[key];
					const {quantity, unitCost} = value;
					if (quantity != null && unitCost != null) 
						value.price = quantity * unitCost;
					return [key, value];
				})
			);

			function yey() {
				render(Table, {data, columns, selection: true, sorting: true})
			}
		</script>
	</head>
	<body onload="yey()">
		<link href='http://localhost:3000/css/core/button.css' rel='stylesheet'>
<link href='http://localhost:3000/css/partials/app-banner.css' rel='stylesheet'>

<nav role='banner' class='app-banner'>
	<a class='banner-logo' href='http://ubcfarm.ubc.ca/'>
		<img alt='UBC Farm' class='banner-logo-img' height='32' width='109'
			src='http://ubcfarm.ubc.ca/files/2014/04/ubc-farm-horizontal-cropped-360x106.jpg'>
	</a>
	<label aria-label='Apps' title='Apps' role='button'
		class='material-icons icon-button' for='app-menu-toggle'>apps</label>
	<a aria-label='Help' title='Help' class='material-icons icon-button' 
		href='https://github.com/NotWoods/ubc-farm/issues'>help</a>
	<a aria-label='Account' title='Account' href='/account' 
		class='material-icons icon-button'>face</a>

	<input id='app-menu-toggle' type='checkbox' 
		value='app_menu_toggle' hidden class='hidden-checkbox'>
	<section class='app-menu'>
		<a href='/fields' class='app-menu-item'>
			<i class='material-icons md-36 app-menu-icon'>map</i>
			Fields
		</a>
		<a href='/finances' class='app-menu-item'>
			<i class='material-icons md-36 app-menu-icon'>attach_money</i>
			Finances
		</a>
		<a href='/calendar' class='app-menu-item'>
			<i class='material-icons md-36 app-menu-icon'>event</i>
			Calendar
		</a>
		<a href='/directory' class='app-menu-item'>
			<i class='material-icons md-36 app-menu-icon'>people</i>
			Directory
		</a>
	</section>
</nav>
<link href='http://localhost:3000/css/core/heading.css' rel='stylesheet'>
<link href='http://localhost:3000/css/partials/section-banner.css' rel='stylesheet'>

<header class='section-banner' role='toolbar'>
	<nav class='banner-breadcrumbs'>
			<a class='banner-breadcrumb' href='/finances'>
				<h1 class='title banner-header'>Finances</h1>
			</a>
			<i class='material-icons breadcrumb-icon'>keyboard_arrow_right</i>
			<a class='banner-breadcrumb' href='/finances/sales'>
				<h1 class='title banner-header'>Sales</h1>
			</a>
	</nav>
</header>
		<div id='app-mount'/>
	</body>
</html>